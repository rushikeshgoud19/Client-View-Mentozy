import{a as S,r as u,j as e,C as P,L as k,A as $,g as A,t as f}from"./index-DZqTk1Xt.js";import{C as G}from"./chevron-down-CJHlAUJq.js";import{C as D}from"./circle-check-DYJKQIFk.js";function L(){const c=S(),[s,l]=u.useState(1),[r,b]=u.useState({fullName:"",age:"",phone:"",email:"",password:"",grade:"",school:"",interests:[],parentEmail:""}),[x,g]=u.useState(!1),[t,p]=u.useState({}),o=(a,i)=>{b(n=>({...n,[a]:i})),t[a]&&p(n=>({...n,[a]:""}))},y=a=>{const i=r.interests;i.includes(a)?o("interests",i.filter(n=>n!==a)):o("interests",[...i,a])},m=parseInt(r.age)<16,j=()=>{const a={};if(s===1&&(r.fullName||(a.fullName="Full Name is required"),r.age||(a.age="Age is required"),(!r.email||!/^\S+@\S+\.\S+$/.test(r.email))&&(a.email="Valid Email is required"),(!r.password||r.password.length<6)&&(a.password="Password must be at least 6 characters"),r.phone||(a.phone="Phone is required")),s===2&&(r.grade||(a.grade="Please select your grade")),s===3&&r.interests.length===0&&(a.interests="Select at least one interest"),s===4&&m&&(!r.parentEmail||!/^\S+@\S+\.\S+$/.test(r.parentEmail))&&(a.parentEmail="Parent email is required for students under 16"),Object.keys(a).length>0){p(a);return}s===1?l(2):s===2?l(3):s===3?l(m?4:5):s===4?l(5):s===5&&N()},N=async()=>{g(!0);try{const a=A();if(!a)throw new Error("Supabase not initialized");let{data:i,error:n}=await a.auth.signUp({email:r.email,password:r.password});if(n&&n.message.includes("already registered")){console.log("User exists, attempting sign in...");const{data:E,error:C}=await a.auth.signInWithPassword({email:r.email,password:r.password});if(C)throw new Error("Account exists but password was incorrect.");i=E,n=null}if(n)throw n;if(!i.user)throw new Error("No user created");const{error:h}=await a.from("profiles").upsert({id:i.user.id,full_name:r.fullName,grade:r.grade,school:r.school,phone:r.phone,interests:r.interests,role:"student"});h&&(console.error("Profile creation failed:",h),f.error("Account created but profile setup had issues. Please contact support.")),c("/student-dashboard")}catch(a){console.error("Signup failed:",a);const i=a instanceof Error?a.message:"Failed to create account";f.error(i)}finally{g(!1)}},v=()=>{s===1?c("/student-auth"):s===2?l(1):s===3?l(2):s===4?l(3):s===5&&l(m?4:3)},w=["Computer Science","Mathematics","Physics","Literature","Design","Business","Robotics","Psychology","History","Music"];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col font-sans",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"max-w-5xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold tracking-tight text-gray-900",children:"Mentozy"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-amber-500 rounded-sm"})]}),e.jsxs("div",{className:"text-sm font-medium text-gray-500",children:["Step ",s," of 5"]})]})}),e.jsx("div",{className:"flex-grow flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-5xl w-full bg-white rounded-3xl shadow-xl overflow-hidden flex flex-col md:flex-row min-h-[600px]",children:[e.jsxs("div",{className:"md:w-5/12 bg-gray-900 p-10 md:p-14 text-white flex flex-col justify-between relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-amber-500/20 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h2",{className:"text-3xl font-bold mb-4 leading-tight",children:[s===1&&"Tell us about yourself",s===2&&"Your academic details",s===3&&"What are you interested in learning?",s===4&&"Parent/Guardian Details",s===5&&"Review & Confirm"]}),e.jsxs("p",{className:"text-gray-400 text-lg",children:[s===1&&"Let's get the basics down so we can personalize your experience.",s===2&&"Help us understand where you are in your education.",s===3&&"Select topics you want to learn more about.",s===4&&"For safety, we need to keep your guardians in the loop.",s===5&&"Almost there! Double check your details below."]})]}),e.jsx("div",{className:"flex gap-2 mt-8 md:mt-0",children:[1,2,3,4,5].map(a=>e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-500 ${a===s?"w-8 bg-amber-500":a<s?"w-8 bg-amber-500/50":"w-2 bg-gray-700"}`},a))})]}),e.jsxs("div",{className:"md:w-7/12 p-10 md:p-14 flex flex-col",children:[e.jsxs("div",{className:"flex-grow",children:[s===1&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Full Name"}),e.jsx("input",{value:r.fullName,onChange:a=>o("fullName",a.target.value),type:"text",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.fullName?"border-red-300 ring-2 ring-red-100":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"e.g. John Doe"}),t.fullName&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:t.fullName})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Age"}),e.jsx("input",{value:r.age,onChange:a=>o("age",a.target.value),type:"number",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.age?"border-red-300":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"18"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Phone"}),e.jsx("input",{value:r.phone,onChange:a=>o("phone",a.target.value),type:"tel",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.phone?"border-red-300":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"+1 234..."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Email Address"}),e.jsx("input",{value:r.email,onChange:a=>o("email",a.target.value),type:"email",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.email?"border-red-300 ring-2 ring-red-100":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"john@example.com"}),t.email&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:t.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Create Password"}),e.jsx("input",{value:r.password,onChange:a=>o("password",a.target.value),type:"password",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.password?"border-red-300":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"Min. 6 characters"}),t.password&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:t.password})]})]}),s===2&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Current Grade / Class"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:r.grade,onChange:a=>o("grade",a.target.value),className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.grade?"border-red-300":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all appearance-none cursor-pointer`,children:[e.jsx("option",{value:"",children:"Select your grade"}),e.jsx("option",{value:"9",children:"Grade 9"}),e.jsx("option",{value:"10",children:"Grade 10"}),e.jsx("option",{value:"11",children:"Grade 11"}),e.jsx("option",{value:"12",children:"Grade 12"}),e.jsx("option",{value:"college",children:"College / University"}),e.jsx("option",{value:"grad",children:"Graduate"})]}),e.jsx(G,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"})]}),t.grade&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:t.grade})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-900",children:["School / Institution ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),e.jsx("input",{value:r.school,onChange:a=>o("school",a.target.value),type:"text",className:"w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200 outline-none transition-all",placeholder:"Enter school name"})]})]}),s===3&&e.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900 block mb-4",children:"Select topics you enjoy"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:w.map(a=>e.jsx("button",{onClick:()=>y(a),className:`px-4 py-2 rounded-full text-sm font-medium border transition-all duration-200 ${r.interests.includes(a)?"bg-amber-100 border-amber-300 text-amber-800 shadow-sm":"bg-white border-gray-200 text-gray-600 hover:border-amber-200 hover:bg-gray-50"}`,children:a},a))}),t.interests&&e.jsx("p",{className:"text-xs text-red-500 font-medium mt-2",children:t.interests})]})}),s===4&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(P,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-amber-800",children:"Since you are under 16, we require a parent or guardian email for safety and communication purposes."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Parent / Guardian Email"}),e.jsx("input",{value:r.parentEmail,onChange:a=>o("parentEmail",a.target.value),type:"email",className:`w-full px-4 py-3 rounded-xl bg-gray-50 border ${t.parentEmail?"border-red-300":"border-gray-200 focus:border-amber-500 focus:ring-2 focus:ring-amber-200"} outline-none transition-all`,placeholder:"parent@example.com"}),t.parentEmail&&e.jsx("p",{className:"text-xs text-red-500 font-medium",children:t.parentEmail})]})]}),s===5&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{label:"Name",value:r.fullName,onEdit:()=>l(1)}),e.jsx(d,{label:"Email",value:r.email,onEdit:()=>l(1)}),e.jsx(d,{label:"Grade",value:r.grade,onEdit:()=>l(2)}),e.jsx(d,{label:"Interests",value:r.interests.join(", "),onEdit:()=>l(3)}),m&&e.jsx(d,{label:"Guardian Email",value:r.parentEmail,onEdit:()=>l(4)})]}),e.jsxs("p",{className:"text-xs text-gray-500 text-center mt-4",children:["By creating an account, you agree to our ",e.jsx("a",{href:"#",className:"text-amber-600 underline",children:"Terms"})," & ",e.jsx("a",{href:"#",className:"text-amber-600 underline",children:"Privacy Policy"}),"."]})]})]}),e.jsxs("div",{className:"mt-10 flex items-center justify-between",children:[e.jsx("button",{onClick:v,className:"px-6 py-3 rounded-xl text-sm font-bold text-gray-500 hover:text-gray-900 hover:bg-gray-100 transition-colors",children:"Back"}),e.jsx("button",{onClick:j,disabled:x,className:"px-8 py-3 bg-amber-500 hover:bg-amber-600 text-white rounded-xl text-sm font-bold shadow-lg shadow-amber-500/20 hover:-translate-y-0.5 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:x?e.jsx(k,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[s===5?"Create Account":"Next",s===5?e.jsx(D,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})]})})]})]})]})})]})}function d({label:c,value:s,onEdit:l}){return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-xl border border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide",children:c}),e.jsx("p",{className:"text-gray-900 font-medium",children:s})]}),e.jsx("button",{onClick:l,className:"text-xs font-bold text-amber-600 hover:text-amber-700",children:"Edit"})]})}export{L as StudentOnboardingPage};
