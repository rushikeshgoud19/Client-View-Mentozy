import{a as N,r as x,j as e,L as v,g as E,t as f}from"./index-DZqTk1Xt.js";import{B as b}from"./briefcase-Y976DXI_.js";import{U as C}from"./user-D72E50nT.js";import{B as k}from"./building-BcllP4wk.js";import{A as S}from"./award-Dz8yzv_6.js";import{C as _}from"./circle-check-DYJKQIFk.js";function F(){const g=N(),[d,u]=x.useState(!1),[r,h]=x.useState({fullName:"",email:"",password:"",role:"",company:"",expertise:""}),t=n=>{h({...r,[n.target.name]:n.target.value})},y=async n=>{n.preventDefault(),u(!0);try{const s=E();if(!s)throw new Error("Supabase client not initialized");let{data:o,error:l}=await s.auth.signUp({email:r.email,password:r.password,options:{data:{full_name:r.fullName,role:"mentor"}}});if(l&&l.message.includes("already registered")){console.log("User exists, attempting sign in...");const{data:c,error:a}=await s.auth.signInWithPassword({email:r.email,password:r.password});if(a)throw new Error("Account exists but password was incorrect.");o=c,l=null}if(l)throw l;if(!o.user)throw new Error("No user returned from signup");if(!o.session)throw new Error("Please check your email to confirm your account before creating a profile.");const{error:m}=await s.from("profiles").upsert({id:o.user.id,full_name:r.fullName,role:"mentor"});if(m)throw m;const{data:w,error:i}=await s.from("mentors").upsert({user_id:o.user.id,bio:r.role,company:r.company,years_experience:0,hourly_rate:0,rating:5,total_reviews:0},{onConflict:"user_id"}).select().single();if(i)throw i;if(r.expertise){const c=r.expertise.split(",").map(a=>a.trim()).filter(a=>a);if(c.length>0){const a=c.map(j=>({mentor_id:w.id,skill:j})),{error:p}=await s.from("mentor_expertise").upsert(a,{onConflict:"mentor_id,skill"});if(p)throw p}}if(i)throw i;f.success("Welcome, Mentor! account created successfully."),g("/mentor-dashboard")}catch(s){console.error("Mentor Signup Error:",s),f.error(s.message||"Failed to create mentor account")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 font-sans",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 mb-4",children:e.jsx(b,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Join as a Mentor"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Share your knowledge and guide the next generation."})]}),e.jsxs("form",{className:"space-y-5",onSubmit:y,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{name:"fullName",type:"text",required:!0,value:r.fullName,onChange:t,className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"Ex. Jane Doe"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Email"}),e.jsx("input",{name:"email",type:"email",required:!0,value:r.email,onChange:t,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"jane@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{name:"password",type:"password",required:!0,minLength:6,value:r.password,onChange:t,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"Min. 6 characters"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Role"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{name:"role",type:"text",required:!0,value:r.role,onChange:t,className:"w-full pl-9 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"Ex. Sr. Engineer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{name:"company",type:"text",required:!0,value:r.company,onChange:t,className:"w-full pl-9 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"Ex. Tech Corp"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Key Expertise (comma separated)"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{name:"expertise",type:"text",required:!0,value:r.expertise,onChange:t,className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none",placeholder:"Ex. React, System Design, Leadership"})]})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg shadow-blue-600/20 disabled:opacity-70 disabled:cursor-not-allowed",children:d?e.jsx(v,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Create Mentor Profile ",e.jsx(_,{className:"w-5 h-5"})]})})]})]})})}export{F as MentorOnboardingPage};
